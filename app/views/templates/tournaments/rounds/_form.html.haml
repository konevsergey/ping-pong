%div{:'ng-if' => 'vm.rounds'}
  %h5
    %ol
      %li{:'ng-repeat' => 'round in vm.rounds'}
        %p
          {{round.form}}: {{round.match_sets}} sets
          %span{:'ng-show' => "round.form.trim()=='#{ROUND_FORMS::CHAMPIONSHIP}'"}
            {{round.points_per_win}} points per win

=render_button 'add', :'ng-click' => 'vm.showAddingRound = true; vm.tmp_rounds.push({ match_sets: 1, points_per_win: 1 })',
                      :'ng-show' => '!vm.showAddingRound'

%div{:'ng-if' => 'vm.showAddingRound'}
  %ng-form{ :class => 'form-horizontal',
         :role => 'form',
         :name => 'form',
         :novalidate => true}

    .form-group.required{ :'ng-class' => "{ 'has-error': form.form.$touched && form.form.$invalid }" }
      %label{ class: 'control-label col-md-3' } Type:
      .col-md-8
        %select.form-control{:'ng-model' => 'vm.tmp_rounds[vm.tmp_rounds.length-1].form',
                             :name => 'form',
                             :required => true}
          %option
          %option=ROUND_FORMS::CHAMPIONSHIP
          %option=ROUND_FORMS::PLAY_OFF

    .form-group.required{ :'ng-class' => "{ 'has-error': form.match_sets.$touched && form.match_sets.$invalid }" }
      %label{ class: 'control-label col-md-3' } Match sets:
      .col-md-8
        %input.form-control{ :'ng-model' => 'vm.tmp_rounds[vm.tmp_rounds.length-1].match_sets',
                                  :name => 'match_sets',
                                  :required => true,
                                  :type => "number",
                                  :'min' => 1 }

    .form-group.required{ :'ng-class' => "{ 'has-error': form.points_per_win.$touched && form.points_per_win.$invalid }",
                          :'ng-if' => "vm.tmp_rounds[vm.tmp_rounds.length-1].form.trim()=='#{ROUND_FORMS::CHAMPIONSHIP}'"}
      %label{ class: 'control-label col-md-4' } Points per win:
      .col-md-7
        %input.form-control{ :'ng-model' => 'vm.tmp_rounds[vm.tmp_rounds.length-1].points_per_win',
                                  :name => 'points_per_win',
                                  :required => true,
                                  :type => "number",
                                  :'min' => 0 }

    .form-group
      .col-md-offset-3.col-md-8
        =render_button 'ok', :'ng-disabled' => 'form.$invalid',
                             :'ng-click' => 'vm.showAddingRound = false; vm.rounds.push(vm.tmp_rounds.pop())',
                             :type => 'button'
        =render_button 'cancel', :'ng-click' => 'vm.showAddingRound = false; vm.tmp_rounds.pop()'
